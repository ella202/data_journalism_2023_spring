---
title: "Data Anylsis Project"
output: html_notebook
---

```{r}
library(tidyverse)
library(dplyr)
library(janitor)
library(corrr)
```

```{r}
spotify_youtube <- read_csv("data_analysis/Spotify_Youtube.csv")
```

The dataset contains 28 columns and 20,718 rows. One thing we have to figure out for our project to answer our third question, "What album type makes up the top five most popular songs?" is how to define "popular". The dataset provides columns like iews, likes, comments and streams. Will/Should we just base it off views? likes? A comination of multiple?

We also wern't sure what "danceability" meant and how it was defined. According to Tableau, danceability is "measured using a mixture of song features such as beat strength, tempo stability, and overall tempo. The value returned determines the ease with which a person could dance to a song over the course of the whole song."
https://www.tableau.com/blog/danceability#:~:text=Danceability%20is%20measured%20using%20a,course%20of%20the%20whole%20song.

We also wern't sure what instrumentalness meant and what the values for that colummn indicated. Instrumentalness is defined as "This value represents the amount of vocals in the song. The closer it is to 1.0, the more instrumental the song is." This means, when comparing the first two songs shown in our dataset, Feel Good Inc. is a more instrumental song in comparison to Rhinestone Eyes, because its instrumentalness value is closer to 1.


```{r}
clean_spotify_youtube <- spotify_youtube %>%
clean_names()
```

```{r}
new_spotify_youtube <- clean_spotify_youtube %>%
  na.omit(datacollected) 
```
For Q1+Q2: filter for outliars and figure out correlation using library(corrr)
### Question 1

**Question text** [Is there a difference in listenership between faster tempo and lower tempo songs?]
* **Analysis summary**: [It looks like there are a lot more songs above the average tempo in the dataframe — 120.6 BPM.I also noticed there's a concentration of more streams near the average and around a tempo of 175 BPM. There are 17 songs with unusually low tempos (equal to zero), after filtering them more than half of them were various white noise and sleep music tracks. There were two songs with unusually high tempo (above 225), I noticed that they had a low number of streams. It turns out there is no relationship or correlation between tempo and the number of streams or listenership of a track according to the data.  ]

```{r}
new_spotify_youtube %>%
summarize(mean(tempo))
```
```{r}
high_tempo <- new_spotify_youtube %>%
  filter(tempo > 120.6072)

ggplot(data = high_tempo) + 
  geom_point(mapping = aes(x = stream, y = tempo))
```

```{r}
low_tempo <- new_spotify_youtube %>%
filter(tempo < 120.6072 )

ggplot(data = low_tempo) + 
  geom_point(mapping = aes(x = stream, y = tempo))
```
#filtering for outliers

```{r}
low_tempo_outlier <- low_tempo %>%
filter(tempo < 10 )
```

```{r}
high_tempo_outlier <- high_tempo %>%
  filter(tempo > 225)
```

#correlation!

```{r}
new_spotify_youtube %>%
  select(-artist, -url_spotify, -track, -album, -album_type, -uri, -url_youtube, -title, -channel, -description, -licensed, -official_video) %>%
  correlate() %>%
  select(term, stream )
```

### Question 2

* **Question text**:[Is there correlation between danceability of songs and their number of streams? 
* **Analysis summary**: [Songs with danceability above .5 appear to have amassed a lot of streams compared to those below. There were outlier tracks with extremely high number of streams (over three billion) and higher danceability. Even with the dot plot there is no correlation between a song's danceability and its number of streams.]

```{r}
 ggplot(data = new_spotify_youtube) + 
  geom_point(mapping = aes(x = stream, y = danceability))
```
#filtering for outliers
```{r}
new_spotify_youtube %>%
  filter(stream > 3e+09)
```


#correlation!
```{r}
new_spotify_youtube %>%
  select(-artist, -url_spotify, -track, -album, -album_type, -uri, -url_youtube, -title, -channel, -description, -licensed, -official_video) %>%
  correlate() %>%
  select(term, stream )
```


### Question 3

* **Question text**: [What album type makes up the top most popular songs?] 
* **Analysis summary**: [The top 20 most streamed songs are a part of albums with over 70 percent. Even when we expand the number of popular songs we're sampling from, most of them still appear to be a part of albums over compilations and singles.]

```{r}
top_20_stream <- new_spotify_youtube %>%
  arrange(desc(stream)) %>%
  head(20)

count_album_type <- top_20_stream %>%
  count(album_type)

count_album_type_all <- new_spotify_youtube %>%
  count(album_type)

percent_album_type_all <- count_album_type_all %>%
  mutate(percent = n / sum(n) * 100)
```


### Question 4

* **Question text**: [Do instrumental tracks have a higher or lower average tempo than vocal tracks?]
* **Analysis summary**: [Austin helped me realize this question is a bit harder to analyze than I thought. It's hard to narrow down what constitutes a completely instrumental track even with the data we have. We'll probably have to rework this. ]

```{r}
instrumental_tracks <- new_spotify_youtube %>%
  filter(instrumentalness == 1)
```

### Question 5

* **Question text**: [What’s the danceability score of songs with high speechiness?]
* **Analysis summary**: [Danceability was higher in songs with high speechiness. Instead of using the top 20 or the entire dataframe, maybe we should have maybe analyzed all the songs with above average speechiness so that we have a larger sample size.]
```{r}
top_20_speechiness <- new_spotify_youtube %>%
  arrange(desc(speechiness)) %>%
  head(20)

avg_danceability_top_20 <- mean(top_20_speechiness$danceability)

avg_danceability_all <- mean(new_spotify_youtube$danceability)
```